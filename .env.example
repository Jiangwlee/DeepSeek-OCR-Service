# ----------------------------------------------------------------------------
# Compose Project Metadata
# ----------------------------------------------------------------------------
COMPOSE_PROJECT_NAME=deepseek-ocr

# ----------------------------------------------------------------------------
# MinIO Configuration
# ----------------------------------------------------------------------------
MINIO_ROOT_USER=deepseekadmin
MINIO_ROOT_PASSWORD=deepseeksecret
MINIO_REGION=cn-north-1
MINIO_DATA_DIR=./.data/minio/data
MINIO_CONFIG_DIR=./.data/minio/config
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001
# Space-separated bucket list created on startup
MINIO_BUCKETS=raw-docs,converted-pdf,page-images,ocr-results
# Optional bucket that should be world-readable
MINIO_PUBLIC_BUCKET=
# External URL components (used by other services when generating presigned URLs)
MINIO_EXTERNAL_SCHEME=http
MINIO_EXTERNAL_DOMAIN=localhost
MINIO_EXTERNAL_PORT=9000

# ----------------------------------------------------------------------------
# OCR Service Configuration
# ----------------------------------------------------------------------------
# vLLM API endpoint configuration (OCR service connects to vLLM service)
OCR_VLLM_API_BASE=http://vllm-service:8000/v1
OCR_VLLM_API_KEY=EMPTY
OCR_VLLM_MODEL=deepseek-ai/DeepSeek-OCR
OCR_VLLM_REQUEST_TIMEOUT=3600
OCR_VLLM_MAX_TOKENS=2048
OCR_VLLM_TEMPERATURE=0.0
OCR_VLLM_SKIP_SPECIAL_TOKENS=false
OCR_PDF_DPI=144
OCR_MAX_WORKERS=4
OCR_HTTP_PORT=8001
OCR_MINIO_ENABLED=true
OCR_MINIO_ENDPOINT=http://localhost:9000
OCR_MINIO_ACCESS_KEY=deepseekadmin
OCR_MINIO_SECRET_KEY=deepseeksecret
OCR_MINIO_SECURE=false
OCR_MINIO_DEFAULT_BUCKET=ocr-results
OCR_PERSIST_RESULTS_BY_DEFAULT=false

# UI Configuration (JSON格式)
# 可用模型列表 - 每个模型包含: name(显示名称), value(内部标识), endpoint(API端点), model(模型ID)
OCR_UI_AVAILABLE_MODELS=[{"name":"DeepSeek-OCR","value":"deepseek","endpoint":"http://vllm-service:8003/v1","model":"deepseek-ai/DeepSeek-OCR"},{"name":"Qwen3-VL-8B-FP8","value":"qwen3-vl","endpoint":"http://vllm-service:8003/v1","model":"Qwen/Qwen3-VL-8B-Instruct-FP8"},{"name":"PaddleOCR","value":"paddle","endpoint":"http://paddle-ocr:9000","model":"paddleocr"}]

# Prompt 预设列表 - 每个预设包含: name(显示名称), value(prompt内容)
OCR_UI_PROMPT_PRESETS=[{"name":"Markdown (标准)","value":"<image>\\n<|grounding|>Convert the document to markdown."},{"name":"Markdown (高质量)","value":"<image>\\n<|grounding|>Please convert this document to high-quality markdown format, preserving all formatting, tables, and structure."},{"name":"纯文本","value":"<image>\\nFree OCR."},{"name":"表格提取","value":"<image>\\n<|grounding|>Extract all tables from this document in markdown format."},{"name":"公式识别","value":"<image>\\n<|grounding|>Extract all mathematical formulas using LaTeX notation."}]

# ----------------------------------------------------------------------------
# vLLM Service Configuration
# ----------------------------------------------------------------------------
# Model configuration - supports:
#   - deepseek-ai/DeepSeek-OCR (default)
#   - Qwen/Qwen3-VL-8B-Instruct
#   - Qwen/Qwen3-VL-8B-Instruct-FP8 (recommended for lower memory usage)
#   - Or any other vLLM-compatible vision-language model
VLLM_MODEL_NAME=deepseek-ai/DeepSeek-OCR
# Model type: auto (auto-detect), deepseek-ocr, qwen3-vl, generic
VLLM_MODEL_TYPE=auto
# vLLM server settings
VLLM_HOST=0.0.0.0
VLLM_PORT=8000
# GPU and performance settings
VLLM_GPU_MEMORY_UTILIZATION=0.6
VLLM_MAX_NUM_SEQS=16
VLLM_MAX_MODEL_LEN=4096
VLLM_MM_PROCESSOR_CACHE_GB=0
# Optional: Tensor parallel size for multi-GPU (leave empty for single GPU)
VLLM_TENSOR_PARALLEL_SIZE=
# Optional: For Qwen3-VL - limit video inputs (0 for image-only)
VLLM_LIMIT_VIDEO_INPUTS=
# Optional: Enable async scheduling for better throughput (Qwen3-VL)
VLLM_ENABLE_ASYNC_SCHEDULING=false
# Optional: Extra vLLM arguments (advanced users)
VLLM_EXTRA_VLLM_ARGS=
# GPU device visibility
VLLM_CUDA_VISIBLE_DEVICES=0

# ----------------------------------------------------------------------------
# PaddleOCR (REST 服务端，通过 endpoint 统一调用，CPU/GPU 由部署决定)
# ----------------------------------------------------------------------------
OCR_PADDLE_ENDPOINT=http://paddle-ocr:9000
OCR_PADDLE_TIMEOUT=60

# Paddle 服务自身（仅当使用本仓库的 paddle-ocr 容器时才需要）
PADDLE_LANG=ch
PADDLE_HTTP_PORT=19000
# CPU: paddlepaddle/paddle:3.2.2
# GPU (CUDA11.8): paddlepaddle/paddle:3.2.2-gpu-cuda11.8-cudnn8.9
# GPU (CUDA12.6): paddlepaddle/paddle:3.2.2-gpu-cuda12.6-cudnn9.5
PADDLE_BASE_IMAGE=paddlepaddle/paddle:3.2.2

NO_PROXY=minio,minio-init,vllm-service,paddle-ocr,ocr,document-converter,bcebos.com,localhost,127.0.0.1,172.30.0.0/16